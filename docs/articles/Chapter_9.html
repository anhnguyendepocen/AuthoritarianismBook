<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Chapter 9: Benevolent Authoritarianism &bull; AuthoritarianismBook</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">AuthoritarianismBook</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Datasets in this package</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/xmarquez/AuthoritarianismBook">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Chapter 9: Benevolent Authoritarianism</h1>
                        <h4 class="author">Xavier Marquez</h4>
            
            <h4 class="date">2016-10-29</h4>
          </div>

    
    
<div class="contents">
<div id="introduction" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#introduction" class="anchor"> </a></body></html>Introduction</h2>
<p>This vignette shows how to replicate and extend the charts in chapter 9 of my book <a href="https://he.palgrave.com/page/detail/non-democratic-politics-xavier-marquez/?sf1=barcode&amp;st1=9781137486301"><em>Non-democratic Politics: Authoritarianism, Dictatorships, and Democratization</em></a> (Palgrave Macmillan, 2016). It assumes that you have downloaded the replication package as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(!<span class="kw">require</span>(devtools)) {
  <span class="kw">install.packages</span>(<span class="st">"devtools"</span>)
}

devtools::<span class="kw">install_github</span>(<span class="st">'xmarquez/AuthoritarianismBook'</span>)</code></pre></div>
<p>It also assumes you have the <code>dplyr</code>, <code>ggplot2</code>, <code>scales</code>, <code>forcats</code>, <code>ggalt</code>, <code>ggrepel</code>, <code>reshape2</code>, and <code>knitr</code> packages installed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(!<span class="kw">require</span>(dplyr)) {
  <span class="kw">install.packages</span>(<span class="st">"dplyr"</span>)
}

if(!<span class="kw">require</span>(ggplot2)) {
  <span class="kw">install.packages</span>(<span class="st">"ggplot2"</span>)
}

if(!<span class="kw">require</span>(scales)) {
  <span class="kw">install.packages</span>(<span class="st">"forcats"</span>)
}

if(!<span class="kw">require</span>(forcats)) {
  <span class="kw">install.packages</span>(<span class="st">"scales"</span>)
}

if(!<span class="kw">require</span>(ggalt)) {
  <span class="kw">install.packages</span>(<span class="st">"ggalt"</span>)
}

if(!<span class="kw">require</span>(ggrepel)) {
  <span class="kw">install.packages</span>(<span class="st">"ggrepel"</span>)
}

if(!<span class="kw">require</span>(reshape2)) {
  <span class="kw">install.packages</span>(<span class="st">"reshape2"</span>)
}

if(!<span class="kw">require</span>(knitr)) {
  <span class="kw">install.packages</span>(<span class="st">"knitr"</span>)
}</code></pre></div>
</div>
<div id="figure-9-1-growth-rates-by-electoral-regime" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#figure-9-1-growth-rates-by-electoral-regime" class="anchor"> </a></body></html>Figure 9.1: Growth rates by electoral regime</h2>
<div id="original-figure" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#original-figure" class="anchor"> </a></body></html>Original figure</h3>
<p>This figure attempts to give a sense of the distribution of the average ranks of yearly growth rates of different regime types, 1950-2014. Since growth rates are volatile and affected by the total state of the world economy at any given time, we do not compare growth rates directly. Instead, we first calculate the growth rate percentile rank for each regime in each year (1 = highest growth in year, 0 - lowest growth in year), and then average these ranks over the entire life of the regime (so, for example, Singapore, an electoral regime with restrictions on competition, averaged a 0.7 from 1965 until 2014, a consistently high growth performer). Each violin then shows the distribution of these averages by regime type, with vertical bars indicating the bottom 10 percent, the median, and the top 10 percent of regimes (so, for example, we can see that the median democratic regime has produced growth in the top 50% of growth rates, when averaged over the life of the regime). Regime data comes from LIED <span class="citation">(Skaaning, Gerring, and Bartusevi&#269;ius 2015)</span>, extending the PIPE dataset from <span class="citation">Przeworski (2013)</span>; economic growth data comes from the Maddison project <span class="citation">(The Maddison Project 2013)</span>, the Penn World Tables <span class="citation">(Feenstra and Timmer 2013)</span>, and the World Bank. There are a total of 793 regimes in the sample (median duration 5 years, though electoral democracies in the sample tend to last longer); areas are scaled to the number of observations in each category.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(AuthoritarianismBook)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)

count_sequence_breaks &lt;-<span class="st"> </span>function(seq, <span class="dt">seq_step =</span> <span class="dv">1</span>) {
  first_diff &lt;-<span class="st"> </span><span class="kw">c</span>(seq_step, <span class="kw">diff</span>(seq)) -<span class="st"> </span>seq_step
  periods &lt;-<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">abs</span>(first_diff))
  periods
}

data &lt;-<span class="st"> </span>economic_data %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(country_name, GWn, year, variable) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(country_name, variable) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">num_years =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="kw">diff</span>(year))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(num_years ==<span class="st"> </span><span class="dv">1</span>, year &gt;=<span class="st"> </span><span class="dv">1950</span>) %&gt;%
<span class="st">  </span><span class="kw">left_join</span>(lied %&gt;%<span class="st"> </span><span class="kw">select</span>(-in_system)) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">regime =</span> <span class="kw">ifelse</span>(lexical_index %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">4</span>),
                         <span class="st">"Electoral regime, restrictions on competition or suffrage"</span>,
                         <span class="kw">ifelse</span>(lexical_index %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>),
                                <span class="st">"Unelected executive, elected legislature"</span>,
                                regime))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(regime)) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(country_name) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">regime_num =</span> <span class="kw">count_sequence_breaks</span>(<span class="kw">unclass</span>(<span class="kw">factor</span>(regime)), <span class="dt">seq_step =</span> <span class="dv">0</span>)) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(variable,year) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">growth_rank =</span> <span class="kw">percent_rank</span>(per_capita_growth)) %&gt;%
<span class="st">  </span><span class="kw">ungroup</span>() %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(country_name, regime_num, regime) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">growth_rank =</span> <span class="kw">mean</span>(growth_rank,<span class="dt">na.rm=</span><span class="ot">TRUE</span>), 
            <span class="dt">min_year =</span> <span class="kw">min</span>(year), 
            <span class="dt">max_year =</span> <span class="kw">max</span>(year), 
            <span class="dt">n =</span> <span class="kw">n</span>(), 
            <span class="dt">total_length =</span> max_year -<span class="st"> </span>min_year)</code></pre></div>
<pre><code>## Joining, by = c("country_name", "GWn", "year")</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> data, 
       <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(regime, growth_rank, <span class="dt">FUN =</span> <span class="st">"median"</span>), 
           <span class="dt">y =</span> growth_rank)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_violin</span>(<span class="dt">draw_quantiles =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.9</span>),
              <span class="dt">fill=</span><span class="st">"lightgrey"</span>, 
              <span class="dt">scale=</span><span class="st">"count"</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">"Distribution of the average rank of</span>
<span class="st">       the regime's yearly growth rate </span><span class="ch">\n</span><span class="st">over its entire life</span>
<span class="st">       (percentile scale, </span><span class="ch">\n</span><span class="st">1 means best growth performance)"</span>,
       <span class="dt">x =</span> <span class="st">""</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">coord_flip</span>() +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">"red"</span>)</code></pre></div>
<p><img src="Chapter_9_files/figure-html/fig_9_1-1.png" width="672"></p>
</div>
<div id="extension-disaggregating-the-data-per-country" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#extension-disaggregating-the-data-per-country" class="anchor"> </a></body></html>Extension: Disaggregating the data per country</h3>
<p>There are a couple of ways of disaggregating this data. We can show the actual growth ranks:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span>economic_data %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(country_name, GWn, year, variable) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(country_name, variable) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">num_years =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="kw">diff</span>(year))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(num_years ==<span class="st"> </span><span class="dv">1</span>, year &gt;=<span class="st"> </span><span class="dv">1950</span>) %&gt;%
<span class="st">  </span><span class="kw">left_join</span>(lied %&gt;%<span class="st"> </span><span class="kw">select</span>(-in_system)) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">regime =</span> <span class="kw">ifelse</span>(lexical_index %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">4</span>),
                         <span class="st">"Electoral regime, restrictions on competition or suffrage"</span>,
                         <span class="kw">ifelse</span>(lexical_index %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>),
                                <span class="st">"Unelected executive, elected legislature"</span>,
                                regime))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(regime)) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(country_name) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">regime_num =</span> <span class="kw">count_sequence_breaks</span>(<span class="kw">unclass</span>(<span class="kw">factor</span>(regime)), <span class="dt">seq_step =</span> <span class="dv">0</span>)) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(variable,year) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">growth_rank =</span> <span class="kw">percent_rank</span>(per_capita_growth)) %&gt;%
<span class="st">  </span><span class="kw">ungroup</span>() %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(country_name, regime_num, regime) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">min_year =</span> <span class="kw">min</span>(year),
         <span class="dt">max_year =</span> <span class="kw">max</span>(year),
         <span class="dt">n =</span> <span class="kw">n</span>(),
         <span class="dt">total_length =</span> max_year -<span class="st"> </span>min_year) %&gt;%
<span class="st">  </span><span class="kw">ungroup</span>()</code></pre></div>
<pre><code>## Joining, by = c("country_name", "GWn", "year")</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> data, 
       <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(country_name, growth_rank),
           <span class="dt">y =</span> growth_rank,
           <span class="dt">color =</span> regime)) +
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">alpha =</span> n,
                   <span class="dt">group =</span> <span class="kw">paste</span>(country_name, regime, regime_num)),
               <span class="dt">varwidth =</span> <span class="ot">TRUE</span>) +
<span class="st">  </span><span class="kw">geom_violin</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">""</span>,
       <span class="dt">color =</span> <span class="st">"Regime type"</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"top"</span>) +
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">title.position =</span> <span class="st">"top"</span>, <span class="dt">ncol =</span> <span class="dv">1</span>)) +
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="Chapter_9_files/figure-html/fig_9_1_disag-1.png" width="672"></p>
<p>Or we can plot the actual income trajectories:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span>economic_data %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(country_name, GWn, year, variable) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(per_capita), year &gt;=<span class="st"> </span><span class="dv">1950</span>) %&gt;%
<span class="st">  </span><span class="kw">inner_join</span>(lied %&gt;%<span class="st"> </span><span class="kw">select</span>(-cown:-in_system)) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">regime =</span> <span class="kw">ifelse</span>(lexical_index %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">4</span>),
                         <span class="st">"Electoral regime, restrictions on competition or suffrage"</span>,
                         <span class="kw">ifelse</span>(lexical_index %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>),
                                <span class="st">"Unelected executive, elected legislature"</span>,
                                regime))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(regime)) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(country_name) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">regime_num =</span> <span class="kw">count_sequence_breaks</span>(<span class="kw">unclass</span>(<span class="kw">factor</span>(regime)), <span class="dt">seq_step =</span> <span class="dv">0</span>)) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(variable, country_name, regime_num) %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(year) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">time =</span> year -<span class="st"> </span><span class="kw">first</span>(year),
         <span class="dt">normalized_income =</span> per_capita/<span class="kw">first</span>(per_capita)) %&gt;%
<span class="st">  </span><span class="kw">ungroup</span>() </code></pre></div>
<pre><code>## Joining, by = c("country_name", "GWn", "year")</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> data %&gt;%<span class="st"> </span><span class="kw">filter</span>(primary_source ==<span class="st"> "PWT8.1"</span>),
       <span class="kw">aes</span>(<span class="dt">x =</span> time, 
           <span class="dt">y =</span> normalized_income,
           <span class="dt">color =</span> regime,
           <span class="dt">group =</span> <span class="kw">paste</span>(country_name, regime_num))) +
<span class="st">  </span><span class="kw">geom_path</span>() +
<span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> data %&gt;%
<span class="st">              </span><span class="kw">group_by</span>(country_name, variable) %&gt;%
<span class="st">              </span><span class="kw">filter</span>(time ==<span class="st"> </span><span class="kw">max</span>(time, <span class="dt">na.rm=</span><span class="ot">TRUE</span>),
                     primary_source ==<span class="st"> "PWT8.1"</span>),
            <span class="kw">aes</span>(<span class="dt">x =</span> time,
                <span class="dt">y =</span> normalized_income,
                <span class="dt">label =</span> <span class="kw">paste</span>(country_name, year)),
            <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>,
            <span class="dt">color =</span> <span class="st">"black"</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">"Ratio of increase in GDP per capita </span>
<span class="st">       over the life of the regime"</span>,
       <span class="dt">x =</span> <span class="st">"Regime duration"</span>,
       <span class="dt">color =</span> <span class="st">""</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) +
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">title.position =</span> <span class="st">"top"</span>, <span class="dt">ncol =</span> <span class="dv">1</span>)) +
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">type =</span> <span class="st">"qual"</span>, <span class="dt">palette =</span> <span class="st">"Set1"</span>) +
<span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="dt">labels =</span> scales::percent) +
<span class="st">  </span><span class="kw">facet_wrap</span>(~variable, <span class="dt">ncol =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="Chapter_9_files/figure-html/fig_9_1_extension-1.png" width="672"></p>
</div>
</div>
<div id="figure-9-2-distribution-of-the-average-ranks-of-yearly-growth-rates-of-different-regime-types-1950-2010" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#figure-9-2-distribution-of-the-average-ranks-of-yearly-growth-rates-of-different-regime-types-1950-2010" class="anchor"> </a></body></html>Figure 9.2: Distribution of the average ranks of yearly growth rates of different regime types, 1950-2010</h2>
<div id="original-figure-1" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#original-figure-1" class="anchor"> </a></body></html>Original figure</h3>
<p>As in the previous figure, we first calculate the growth rate percentile rank for each regime in each year (1 = highest growth in year, 0 - lowest growth in year), and then average these ranks over the entire life of the regime. Each violin shows the distribution of these averages by regime type, with vertical bars indicating the bottom 10 percent, the median, and the top 10 percent of regimes. Regime data comes from <span class="citation">Geddes, Wright, and Frantz (2014)</span>; economic growth data comes from the Maddison project <span class="citation">(The Maddison Project 2013)</span>, the Penn World Tables <span class="citation">(Feenstra and Timmer 2013)</span>, and the World Bank. There are a total of 461 regimes in the sample (median duration 10 years, though some last much longer); areas are scaled to the number of observations in each category.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span>economic_data %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(country_name, GWn, year, variable) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(country_name, variable) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">num_years =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="kw">diff</span>(year))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(num_years ==<span class="st"> </span><span class="dv">1</span>,year &gt;=<span class="st"> </span><span class="dv">1950</span>) %&gt;%
<span class="st">  </span><span class="kw">left_join</span>(all_gwf_extended_yearly %&gt;%<span class="st"> </span>
<span class="st">              </span><span class="kw">select</span>(-in_system)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(gwf_full_regimetype)) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(variable, year) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">growth_rank =</span> <span class="kw">percent_rank</span>(per_capita_growth)) %&gt;%
<span class="st">  </span><span class="kw">ungroup</span>() %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">regime =</span> <span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">"monarchy"</span>,gwf_full_regimetype),
                         <span class="st">"Monarchy"</span>,
                         <span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">"democracy"</span>, gwf_full_regimetype),
                                <span class="st">"Democracy"</span>,
                                <span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">"personal"</span>, gwf_full_regimetype),
                                       <span class="st">"Personalized"</span>, <span class="st">"Other non-democracy"</span>)))) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(gwf_casename,country_name,regime) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">growth_rank =</span> <span class="kw">mean</span>(growth_rank, <span class="dt">na.rm=</span><span class="ot">TRUE</span>), 
            <span class="dt">min_year =</span> <span class="kw">min</span>(year), 
            <span class="dt">max_year =</span> <span class="kw">max</span>(year), 
            <span class="dt">n =</span> <span class="kw">n</span>(), 
            <span class="dt">total_length =</span> max_year -<span class="st"> </span>min_year)</code></pre></div>
<pre><code>## Joining, by = c("country_name", "GWn", "year")</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> data, 
       <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(regime, growth_rank, <span class="dt">FUN=</span><span class="st">"median"</span>), 
           <span class="dt">y=</span>growth_rank)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_violin</span>(<span class="dt">draw_quantiles =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.9</span>), 
              <span class="dt">fill=</span><span class="st">"lightgrey"</span>, 
              <span class="dt">scale=</span><span class="st">"count"</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">"Distribution of the average rank of</span>
<span class="st">       the regime's yearly growth rate</span>
<span class="st">       over its entire life</span>
<span class="st">       (percentile scale,</span>
<span class="st">       1 means best growth performance)"</span>,
       <span class="dt">x =</span> <span class="st">""</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">coord_flip</span>() +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">"red"</span>)</code></pre></div>
<p><img src="Chapter_9_files/figure-html/fig_9_2-1.png" width="672"></p>
</div>
</div>
<div id="figure-9-3-income-per-capita-in-north-and-south-korea" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#figure-9-3-income-per-capita-in-north-and-south-korea" class="anchor"> </a></body></html>Figure 9.3: Income per capita in North and South Korea</h2>
<p>Income per capita in North and South Korea, 1950-2010. Regime data from <span class="citation">Geddes, Wright, and Frantz (2014)</span>. Income per capita data comes from the Maddison Project <span class="citation">(The Maddison Project 2013)</span>, in 1993 international dollars. Numbers for North Korea are educated guesswork; figures from 1970-1993 are likely interpolated.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span>economic_data %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(primary_source ==<span class="st"> "Maddison"</span>, 
         <span class="kw">grepl</span>(<span class="st">"Korea"</span>,country_name), 
         year &gt;<span class="st"> </span><span class="dv">1950</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">left_join</span>(all_gwf_extended_yearly %&gt;%<span class="st"> </span><span class="kw">select</span>(-in_system)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">country_name =</span> plyr::<span class="kw">mapvalues</span>(country_name, 
                                        <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">"Korea, People's Republic of"</span>,
                                                 <span class="st">"Korea, Republic of"</span>), 
                                        <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">"North Korea"</span>, 
                                               <span class="st">"South Korea"</span>))) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">num_regime =</span> <span class="kw">unclass</span>(<span class="kw">as.factor</span>(gwf_full_regimetype))) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(country_name) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">period =</span> <span class="kw">count_sequence_breaks</span>(num_regime, <span class="dt">seq_step=</span><span class="dv">0</span>)) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(country_name, period) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">first_year =</span> <span class="kw">min</span>(year))</code></pre></div>
<pre><code>## Joining, by = c("country_name", "GWn", "year")</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="kw">aes</span>(<span class="dt">x =</span> year, 
                        <span class="dt">y =</span> per_capita, 
                        <span class="dt">linetype =</span> country_name,
                        <span class="dt">color =</span> country_name)) +
<span class="st">  </span><span class="kw">geom_path</span>() +
<span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="dt">labels =</span> scales::dollar) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">"Per capita income, 1993 international dollars</span>
<span class="st">       (estimated, from Maddison)"</span>, 
       <span class="dt">linetype =</span> <span class="st">""</span>,
       <span class="dt">color =</span> <span class="st">""</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) +
<span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> data %&gt;%<span class="st"> </span>
<span class="st">              </span><span class="kw">filter</span>(country_name ==<span class="st"> "South Korea"</span>) %&gt;%<span class="st"> </span>
<span class="st">              </span><span class="kw">distinct</span>(first_year, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>),
            <span class="kw">aes</span>(<span class="dt">x=</span>first_year, 
                <span class="dt">y =</span> per_capita, 
                <span class="dt">label =</span> <span class="kw">paste</span>(country_name, gwf_full_regimetype,<span class="dt">sep=</span><span class="st">": "</span>)),
            <span class="dt">angle =</span> <span class="dv">90</span>, 
            <span class="dt">hjust=</span><span class="dv">0</span>) +
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">800</span>,<span class="dv">50000</span>))</code></pre></div>
<p><img src="Chapter_9_files/figure-html/fig_9_3-1.png" width="672"></p>
</div>
<div id="figure-9-4-repression-and-democracy" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#figure-9-4-repression-and-democracy" class="anchor"> </a></body></html>Figure 9.4: Repression and democracy</h2>
<p>Repression and democracy, 1949-2013. The indicator of repression is from <span class="citation">Fariss (2014)</span>; higher values indicate less repression. Democracy data from <span class="citation">Pemstein, Meserve, and Melton (2010)</span>, extended by me <span class="citation">(M&aacute;rquez 2016)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">left_join</span>(fariss %&gt;%<span class="st"> </span><span class="kw">select</span>(-cown:-in_system),
                  extended_uds) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">country_selected =</span> <span class="kw">ifelse</span>(country_name %in%<span class="st"> </span>
<span class="st">                               </span><span class="kw">c</span>(<span class="st">"Chile"</span>),
                               country_name,
                               <span class="st">"Other"</span>))</code></pre></div>
<pre><code>## Joining, by = c("country_name", "GWn", "year", "GWc")</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> data, 
       <span class="kw">aes</span>(<span class="dt">x =</span> adj.z1, 
           <span class="dt">y =</span> latentmean)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">group =</span> country_name,
                 <span class="dt">color =</span> forcats::<span class="kw">fct_rev</span>(country_selected),
                 <span class="dt">alpha =</span> forcats::<span class="kw">fct_rev</span>(country_selected))) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">group =</span> country_name,
                <span class="dt">color =</span> forcats::<span class="kw">fct_rev</span>(country_selected),
                <span class="dt">alpha =</span> forcats::<span class="kw">fct_rev</span>(country_selected))) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">"lm"</span>, 
              <span class="kw">aes</span>(<span class="dt">group =</span> <span class="ot">NULL</span>),
              <span class="dt">color=</span><span class="st">"black"</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> data %&gt;%<span class="st"> </span>
<span class="st">              </span><span class="kw">filter</span>(country_selected !=<span class="st"> "Other"</span>,
                     (year %in%<span class="st"> </span><span class="kw">c</span>(<span class="kw">min</span>(year), 
                                 <span class="kw">max</span>(year))) |
<span class="st">                       </span>(year %%<span class="st"> </span><span class="dv">10</span> ==<span class="st"> </span><span class="dv">0</span>)),
            <span class="kw">aes</span>(<span class="dt">label =</span> year), 
            <span class="dt">color =</span> <span class="st">"black"</span>,
            <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">"red"</span>) +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">"red"</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">"Fariss latent index of repression</span>
<span class="st">       (Higher is less repressive)"</span>, 
       <span class="dt">x =</span><span class="st">"Mean UD score</span>
<span class="st">       (Higher is more democratic)"</span>, 
       <span class="dt">color =</span> <span class="st">"Highlighted country"</span>,
       <span class="dt">alpha =</span> <span class="st">"Highlighted country"</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">title.position =</span><span class="st">"top"</span>),
         <span class="dt">alpha =</span> <span class="kw">guide_legend</span>(<span class="dt">title.position =</span><span class="st">"top"</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) </code></pre></div>
<p><img src="Chapter_9_files/figure-html/fig_9_4-1.png" width="672"></p>
</div>
<div id="figure-9-5-repression-in-different-political-regimes" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#figure-9-5-repression-in-different-political-regimes" class="anchor"> </a></body></html>Figure 9.5: Repression in different political regimes</h1>
<p>Repression and political regimes, 1949-2013. Shapes indicate the density of the distribution of regimes (darker means more concentration of regimes in this 2-dimensional space).The indicator of repression is from <span class="citation">Fariss (2014)</span>; higher values indicate less repression. Regime data comes from <span class="citation">Kailitz (2013)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(reshape2)

data &lt;-<span class="st"> </span><span class="kw">left_join</span>(fariss %&gt;%<span class="st"> </span>
<span class="st">                    </span><span class="kw">select</span>(-cown:-in_system), 
                  extended_uds) %&gt;%
<span class="st">  </span><span class="kw">left_join</span>(kailitz_yearly %&gt;%<span class="st"> </span>
<span class="st">              </span><span class="kw">select</span>(-cown:-in_system, -kailitz_tri) %&gt;%<span class="st"> </span>
<span class="st">              </span><span class="kw">mutate</span>(<span class="dt">democracy =</span> (<span class="kw">grepl</span>(<span class="st">"democracy"</span>,
                                        combined_regime,
                                        <span class="dt">ignore.case =</span> <span class="ot">TRUE</span>)))) %&gt;%
<span class="st">  </span><span class="kw">melt</span>(<span class="dt">measure.vars =</span> <span class="kw">c</span>(<span class="st">"personal"</span>,
                        <span class="st">"communist"</span>,
                        <span class="st">"military"</span>,
                        <span class="st">"party"</span>,
                        <span class="st">"monarchy"</span>,
                        <span class="st">"electoral"</span>,
                        <span class="st">"failure"</span>,
                        <span class="st">"transition"</span>,
                        <span class="st">"democracy"</span>), 
       <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(value) %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(country_name, year) %&gt;%
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">regime =</span> variable) </code></pre></div>
<pre><code>## Joining, by = c("country_name", "GWn", "year", "GWc")
## Joining, by = c("country_name", "GWn", "year", "GWc")</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggalt)

<span class="kw">ggplot</span>(<span class="dt">data =</span> data,
       <span class="kw">aes</span>(<span class="dt">x =</span> adj.z1, <span class="dt">y =</span> latentmean, <span class="dt">group =</span> regime)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">stat_bkde2d</span>(<span class="dt">bandwidth =</span> <span class="kw">c</span>(<span class="fl">0.3</span>,<span class="dv">1</span>), 
              <span class="kw">aes</span>(<span class="dt">alpha=</span>..level..), 
              <span class="dt">geom=</span><span class="st">"polygon"</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">"Fariss latent index of repression</span>
<span class="st">       (Higher is less repressive)"</span>, 
       <span class="dt">x =</span> <span class="st">"Mean UD score</span>
<span class="st">       (Higher is more democratic)"</span>, 
       <span class="dt">alpha =</span> <span class="st">"Density"</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">"red"</span>) +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">"red"</span>) +
<span class="st">  </span><span class="kw">facet_wrap</span>(~regime)</code></pre></div>
<p><img src="Chapter_9_files/figure-html/fig_9_5-1.png" width="672"></p>
<div id="figure-9-6-war-and-democracy-1816-2003" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#figure-9-6-war-and-democracy-1816-2003" class="anchor"> </a></body></html>Figure 9.6: War and democracy, 1816-2003</h2>
<div id="original-figure-2" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#original-figure-2" class="anchor"> </a></body></html>Original figure</h3>
<p>War and democracy, 1816-2003. War data from Gledtisch&rsquo;s updated list of interstate wars <span class="citation">(Gleditsch 2004)</span>. A war in this dataset is an armed conflict with more than 1,000 deaths. Democracy data from <span class="citation">Pemstein, Meserve, and Melton (2010)</span>, extended by the author <span class="citation">(M&aacute;rquez 2016)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">left_join</span>(interstate_dyads_yearly, 
                  extended_uds %&gt;%<span class="st"> </span>
<span class="st">                    </span><span class="kw">rename</span>(<span class="dt">country_name.x =</span> country_name, 
                           <span class="dt">GWn.x =</span> GWn, 
                           <span class="dt">z1.x =</span> z1, 
                           <span class="dt">se.z1.x =</span> se.z1) %&gt;%<span class="st"> </span>
<span class="st">                    </span><span class="kw">select</span>(country_name.x, 
                           GWn.x,
                           year,
                           z1.x,
                           se.z1.x)) %&gt;%
<span class="st">  </span><span class="kw">left_join</span>(extended_uds %&gt;%<span class="st"> </span>
<span class="st">              </span><span class="kw">rename</span>(<span class="dt">country_name.y =</span> country_name, 
                     <span class="dt">GWn.y =</span> GWn, 
                     <span class="dt">z1.y =</span> z1, 
                     <span class="dt">se.z1.y =</span> se.z1) %&gt;%<span class="st"> </span>
<span class="st">              </span><span class="kw">select</span>(country_name.y,
                     GWn.y,
                     year,
                     z1.y,
                     se.z1.y)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(warname,
           country_name.x,
           GWn.x,
           year,
           z1.x,
           se.z1.x,
           country_name.y,
           GWn.y,
           z1.y,
           se.z1.y) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">do</span>(<span class="kw">data.frame</span>(<span class="dt">z1.x.norm =</span> <span class="kw">rnorm</span>(<span class="dv">500</span>,.$z1.x, .$se.z1.x),
                <span class="dt">z1.y.norm =</span> <span class="kw">rnorm</span>(<span class="dv">500</span>,.$z1.y, .$se.z1.y))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>() %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">index.x =</span> <span class="kw">pnorm</span>(z1.x -<span class="st"> </span><span class="fl">0.64</span>), 
         <span class="dt">index.y =</span> <span class="kw">pnorm</span>(z1.y -<span class="st"> </span><span class="fl">0.64</span>), 
         <span class="dt">index.x.norm =</span> <span class="kw">pnorm</span>(z1.x.norm -<span class="st"> </span><span class="fl">0.64</span>), 
         <span class="dt">index.y.norm =</span> <span class="kw">pnorm</span>(z1.y.norm -<span class="st"> </span><span class="fl">0.64</span>), 
         <span class="dt">xmin =</span> <span class="kw">pnorm</span>(z1.x -<span class="st"> </span><span class="fl">0.64</span> -<span class="st"> </span><span class="fl">1.96</span>*se.z1.x), 
         <span class="dt">xmax =</span> <span class="kw">pnorm</span>(z1.x -<span class="st"> </span><span class="fl">0.64</span> +<span class="st"> </span><span class="fl">1.96</span>*se.z1.x), 
         <span class="dt">ymin =</span> <span class="kw">pnorm</span>(z1.y -<span class="st"> </span><span class="fl">0.64</span> -<span class="st"> </span><span class="fl">1.96</span>*se.z1.y), 
         <span class="dt">ymax =</span> <span class="kw">pnorm</span>(z1.y -<span class="st"> </span><span class="fl">0.64</span> +<span class="st"> </span><span class="fl">1.96</span>*se.z1.y))</code></pre></div>
<pre><code>## Joining, by = c("GWn.x", "year", "country_name.x")</code></pre>
<pre><code>## Joining, by = c("year", "GWn.y", "country_name.y")</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggalt)
<span class="kw">library</span>(ggrepel)

demowars &lt;-<span class="st"> </span>data %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(index.x &gt;<span class="st"> </span><span class="fl">0.5</span>, index.y &gt;<span class="st"> </span><span class="fl">0.5</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">distinct</span>(warname, index.x, index.y, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">label =</span> <span class="kw">paste0</span>(warname,<span class="st">": "</span>,country_name.x,<span class="st">" vs. "</span>, country_name.y,<span class="st">", "</span>,year))

<span class="kw">ggplot</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">stat_bkde2d</span>(<span class="dt">data =</span> data, 
              <span class="dt">bandwidth=</span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.05</span>),
              <span class="kw">aes</span>(<span class="dt">x=</span>index.x.norm, 
                  <span class="dt">y=</span>index.y.norm, 
                  <span class="dt">alpha=</span>..level..), 
              <span class="dt">geom=</span><span class="st">"polygon"</span>) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> data %&gt;%<span class="st"> </span>
<span class="st">               </span><span class="kw">distinct</span>(warname, index.x, index.y), 
             <span class="kw">aes</span>(<span class="dt">x=</span>index.x, 
                 <span class="dt">y =</span> index.y)) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">"bottom"</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"UD score of side A in war</span>
<span class="st">       (0-1 probability scale,</span>
<span class="st">       democracies = score &gt;0.5)"</span>,
       <span class="dt">y =</span> <span class="st">"UD score of side B in war</span>
<span class="st">       (0-1 probability scale</span>
<span class="st">       democracies = score &gt;0.5)"</span>, 
       <span class="dt">alpha =</span> <span class="st">"Density"</span>) +
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">"red"</span>) +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">"red"</span>) +
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">"text"</span>, 
           <span class="dt">x =</span> <span class="fl">0.75</span>,
           <span class="dt">y =</span> <span class="fl">0.85</span>,
           <span class="dt">label =</span> <span class="st">"Wars between democracies</span>
<span class="st">           in this quadrant</span>
<span class="st">           (Most of them conflicts within WWII,</span>
<span class="st">           against Finland 1941-1944)"</span>) +
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</code></pre></div>
<p><img src="Chapter_9_files/figure-html/fig_9_6-1.png" width="672"></p>
</div>
<div id="extension-1-wars-per-country" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#extension-1-wars-per-country" class="anchor"> </a></body></html>Extension 1: Wars per country</h3>
<p>It is possible to disaggregate this data per country. The figure below puts countries that have been involved in most wars at the top:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">full_join</span>(extended_uds, all_war_participants_yearly) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">wartime =</span> !<span class="kw">is.na</span>(type)) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(country_name) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">num_wars =</span> <span class="kw">length</span>(<span class="kw">unique</span>(warname[ !<span class="kw">is.na</span>(warname) ]))) %&gt;%
<span class="st">  </span><span class="kw">ungroup</span>() %&gt;%
<span class="st">  </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(index))</code></pre></div>
<pre><code>## Joining, by = c("country_name", "GWn", "year", "GWc")</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> data, 
       <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(country_name, num_wars, mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
           <span class="dt">y =</span> year,
           <span class="dt">alpha =</span> wartime)) +
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> index)) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> type)) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">"top"</span>) +
<span class="st">  </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">midpoint =</span> <span class="fl">0.5</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">""</span>,
       <span class="dt">fill =</span> <span class="st">"Unified democracy score"</span>,
       <span class="dt">alpha =</span> <span class="st">"Wartime?"</span>) +
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="Chapter_9_files/figure-html/war_data_per_country_dem-1.png" width="672"></p>
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor"><html><body><a href="#references" class="anchor"> </a></body></html>References</h1>
<div id="refs" class="references">
<div id="ref-Fariss2014">
<p>Fariss, Christopher J. 2014. &ldquo;Respect for Human Rights Has Improved over Time: Modeling the Changing Standard of Accountability.&rdquo; <em>American Political Science Review</em> 108 (02): 297&ndash;318. doi:<a href="https://doi.org/doi:10.1017/S0003055414000070">doi:10.1017/S0003055414000070</a>.</p>
</div>
<div id="ref-Feenstra2013">
<p>Feenstra, Robert Inklaar, Robert C., and Marcel P. Timmer. 2013. &ldquo;The Next Generation of the Penn World Table.&rdquo; Dataset. <a href="www.ggdc.net/pwt" class="uri">www.ggdc.net/pwt</a>.</p>
</div>
<div id="ref-GeddesWrightFrantz2014">
<p>Geddes, Barbara, Joseph Wright, and Erica Frantz. 2014. &ldquo;Autocratic Breakdown and Regime Transitions: A New Data Set.&rdquo; <em>Perspectives on Politics</em> 12 (1): 313&ndash;31. doi:<a href="https://doi.org/10.1017/S1537592714000851">10.1017/S1537592714000851</a>.</p>
</div>
<div id="ref-Gleditsch2004">
<p>Gleditsch, Kristian. 2004. &ldquo;A Revised List of Wars Between and Within Independent States, 1816-2002.&rdquo; <em>International Interactions</em> 30 (3): 231&ndash;62. <a href="http://privatewww.essex.ac.uk/~ksg/expwar.html" class="uri">http://privatewww.essex.ac.uk/~ksg/expwar.html</a>.</p>
</div>
<div id="ref-Kailitz2013">
<p>Kailitz, Steffen. 2013. &ldquo;Classifying Political Regimes Revisited: Legitimation and Durability.&rdquo; <em>Democratization</em> 20 (1): 39&ndash;60. doi:<a href="https://doi.org/10.1080/13510347.2013.738861">10.1080/13510347.2013.738861</a>.</p>
</div>
<div id="ref-Marquez2016">
<p>M&aacute;rquez, Xavier. 2016. &ldquo;A Quick Method for Extending the Unified Democracy Scores.&rdquo; <em>Available at SSRN 2753830</em>. doi:<a href="https://doi.org/10.2139/ssrn.2753830">10.2139/ssrn.2753830</a>.</p>
</div>
<div id="ref-Pemstein2010">
<p>Pemstein, Daniel, Stephen Meserve, and James Melton. 2010. &ldquo;Democratic Compromise: A Latent Variable Analysis of Ten Measures of Regime Type.&rdquo; <em>Political Analysis</em> 18 (4): 426&ndash;49. doi:<a href="https://doi.org/10.1093/pan/mpq020">10.1093/pan/mpq020</a>.</p>
</div>
<div id="ref-Przeworski2013">
<p>Przeworski, Adam. 2013. &ldquo;Political Institutions and Political Events (PIPE) Data Set.&rdquo; Data set. Department of Politics, New York University. <a href="https://sites.google.com/a/nyu.edu/adam-przeworski/home/data" class="uri">https://sites.google.com/a/nyu.edu/adam-przeworski/home/data</a>.</p>
</div>
<div id="ref-SkaaningGerring2015">
<p>Skaaning, Svend-Erik, John Gerring, and Henrikas Bartusevi&#269;ius. 2015. &ldquo;A Lexical Index of Electoral Democracy.&rdquo; <em>Comparative Political Studies</em> 48 (12): 1491&ndash;1525. doi:<a href="https://doi.org/10.1177/0010414015581050">10.1177/0010414015581050</a>.</p>
</div>
<div id="ref-Maddison2013">
<p>The Maddison Project. 2013. &ldquo;The Maddison Project.&rdquo; Dataset. <a href="http://www.ggdc.net/maddison/maddison-project/home.htm" class="uri">http://www.ggdc.net/maddison/maddison-project/home.htm</a>.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#introduction">Introduction</a></li>
      <li><a href="#figure-9.1-growth-rates-by-electoral-regime">Figure 9.1: Growth rates by electoral regime</a></li>
      <li><a href="#figure-9.2-distribution-of-the-average-ranks-of-yearly-growth-rates-of-different-regime-types-1950-2010">Figure 9.2: Distribution of the average ranks of yearly growth rates of different regime types, 1950-2010</a></li>
      <li><a href="#figure-9.3-income-per-capita-in-north-and-south-korea">Figure 9.3: Income per capita in North and South Korea</a></li>
      <li><a href="#figure-9.4-repression-and-democracy">Figure 9.4: Repression and democracy</a></li>
      <li><a href="#figure-9.5-repression-in-different-political-regimes">Figure 9.5: Repression in different political regimes</a><ul class="nav nav-pills nav-stacked"><li><a href="#figure-9.6-war-and-democracy-1816-2003">Figure 9.6: War and democracy, 1816-2003</a></li>
      </ul></li>
      <li><a href="#references">References</a></li>
      </ul></div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Xavier Marquez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer></div>

  </body></html>
