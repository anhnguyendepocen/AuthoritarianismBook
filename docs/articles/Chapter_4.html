<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Chapter 4: Personal Rule &bull; AuthoritarianismBook</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">AuthoritarianismBook</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Datasets in this package</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/xmarquez/AuthoritarianismBook">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Chapter 4: Personal Rule</h1>
                        <h4 class="author">Xavier Marquez</h4>
            
            <h4 class="date">2016-10-28</h4>
          </div>

    
    
<div class="contents">
<div id="introduction" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#introduction" class="anchor"> </a></body></html>Introduction</h2>
<p>This vignette shows how to replicate and extend the charts in chapter 4 of my book <a href="https://he.palgrave.com/page/detail/non-democratic-politics-xavier-marquez/?sf1=barcode&amp;st1=9781137486301"><em>Non-democratic Politics: Authoritarianism, Dictatorships, and Democratization</em></a> (Palgrave Macmillan, 2016). It assumes that you have downloaded the replication package as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(!<span class="kw">require</span>(devtools)) {
  <span class="kw">install.packages</span>(<span class="st">"devtools"</span>)
}

devtools::<span class="kw">install_github</span>(<span class="st">'xmarquez/AuthoritarianismBook'</span>)</code></pre></div>
<p>It also assumes you have the <code>dplyr</code>, <code>ggplot2</code>, <code>scales</code>, <code>forcats</code>, <code>lubridate</code>, ,<code>ggrepel</code>, <code>maptools</code>, <code>rgeos</code>, and <code>knitr</code> packages installed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(!<span class="kw">require</span>(dplyr)) {
  <span class="kw">install.packages</span>(<span class="st">"dplyr"</span>)
}

if(!<span class="kw">require</span>(ggplot2)) {
  <span class="kw">install.packages</span>(<span class="st">"ggplot2"</span>)
}

if(!<span class="kw">require</span>(scales)) {
  <span class="kw">install.packages</span>(<span class="st">"forcats"</span>)
}

if(!<span class="kw">require</span>(forcats)) {
  <span class="kw">install.packages</span>(<span class="st">"scales"</span>)
}

if(!<span class="kw">require</span>(lubridate)) {
  <span class="kw">install.packages</span>(<span class="st">"lubridate"</span>)
}

if(!<span class="kw">require</span>(knitr)) {
  <span class="kw">install.packages</span>(<span class="st">"knitr"</span>)
}

if(!<span class="kw">require</span>(ggrepel)) {
  <span class="kw">install.packages</span>(<span class="st">"ggrepel"</span>)
}

if(!<span class="kw">require</span>(maptools)) {
  <span class="kw">install.packages</span>(<span class="st">"maptools"</span>)
}

if(!<span class="kw">require</span>(rgeos)) {
  <span class="kw">install.packages</span>(<span class="st">"rgeos"</span>)
}</code></pre></div>
</div>
<div id="figure-4-1-personal-rule-around-the-world" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#figure-4-1-personal-rule-around-the-world" class="anchor"> </a></body></html>Figure 4.1: Personal Rule Around the World</h2>
<div id="original-figure" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#original-figure" class="anchor"> </a></body></html>Original figure</h3>
<p>Figure 4.1 is a chloropleth map of countries according to the degree to which they have experienced personalistic rule. The measure of personal power is a latent variable index of personalism derived from a large number of other measures (and described in more detail in <a href="An_index_of_personal_power.html">this vignette</a>). The leader data is from <span class="citation">Goemans, Gleditsch, and Chiozza (2009)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(AuthoritarianismBook)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(lubridate)

top_leaders &lt;-<span class="st"> </span>personal_scores %&gt;%
<span class="st">  </span><span class="kw">filter</span>(year &gt;=<span class="st"> </span><span class="dv">1900</span>, year &lt;=<span class="st"> </span><span class="dv">2012</span>) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rank_world =</span> <span class="kw">percent_rank</span>(-z1)) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(rank_world &gt;<span class="st"> </span><span class="fl">0.95</span>)

leader_data &lt;-<span class="st"> </span>archigos %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(obsid, GWn, leader, startdate,enddate) %&gt;%
<span class="st">  </span><span class="kw">do</span>(<span class="kw">data.frame</span>(<span class="dt">year =</span> <span class="kw">year</span>(.$startdate):<span class="kw">year</span>(.$enddate)))

top_leaders &lt;-<span class="st"> </span><span class="kw">left_join</span>(top_leaders,leader_data) </code></pre></div>
<pre><code>## Joining, by = c("GWn", "year")</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">top_leaders &lt;-<span class="st"> </span>top_leaders %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(leader)) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(country_name,leader) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">min_year =</span> <span class="kw">min</span>(year), <span class="dt">max_year =</span> <span class="kw">max</span>(year), <span class="dt">avg_z1 =</span> <span class="kw">mean</span>(z1), <span class="dt">startdate =</span> <span class="kw">min</span>(startdate), <span class="dt">enddate =</span> <span class="kw">max</span>(enddate)) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(max_year -<span class="st"> </span>min_year &gt;<span class="st"> </span><span class="dv">1</span>, leader !=<span class="st"> "King of Italy/Emperor of Ethiopia"</span>)

data &lt;-<span class="st"> </span>personal_scores %&gt;%
<span class="st">  </span><span class="kw">filter</span>(year &gt;=<span class="st"> </span><span class="dv">1900</span>, year &lt;=<span class="st"> </span><span class="dv">2012</span>) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(GWn, country_name) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z1 =</span> -z1) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_personalism =</span> <span class="kw">mean</span>(z1,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),
            <span class="dt">sum_personalism =</span> <span class="kw">sum</span>(z1,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),
            <span class="dt">n =</span> <span class="kw">n</span>())

top_leaders &lt;-<span class="st"> </span><span class="kw">left_join</span>(top_leaders,population_data %&gt;%<span class="st"> </span><span class="kw">distinct</span>(country_name,lat,lon))</code></pre></div>
<pre><code>## Joining, by = "country_name"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">world &lt;-<span class="st"> </span>world %&gt;%<span class="st"> </span><span class="kw">filter</span>(id !=<span class="st"> "Antarctica"</span>)

data &lt;-<span class="st"> </span>data %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">country_name =</span> <span class="kw">ifelse</span>(country_name ==<span class="st"> "Germany (Prussia)"</span>, <span class="st">"German Federal Republic"</span>, country_name))

<span class="kw">library</span>(ggrepel)
<span class="kw">ggplot</span>() +<span class="st"> </span><span class="kw">geom_map</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> -sum_personalism,<span class="dt">map_id =</span> country_name),<span class="dt">map =</span> world,<span class="dt">data =</span> data) +
<span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> world,<span class="kw">aes</span>(<span class="dt">y =</span> lat,<span class="dt">x =</span> long,<span class="dt">group =</span> group)) +
<span class="st">  </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">mid =</span> <span class="st">"lightgrey"</span>) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> top_leaders, <span class="kw">aes</span>(<span class="dt">x=</span>lon,<span class="dt">y=</span>lat))  +
<span class="st">  </span><span class="kw">theme_minimal</span>() +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"top"</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">"Sum of personalism index since 1900"</span>,<span class="dt">x =</span> <span class="st">""</span>,<span class="dt">y =</span> <span class="st">""</span>) +
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">title.position =</span> <span class="st">"top"</span>)) +
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="ot">NULL</span>) +
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="ot">NULL</span>) +
<span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> top_leaders, <span class="kw">aes</span>(<span class="dt">x=</span>lon,<span class="dt">y=</span>lat,<span class="dt">label=</span><span class="kw">paste0</span>(leader,<span class="st">"</span><span class="ch">\n</span><span class="st">("</span>,min_year,<span class="st">"-"</span>,max_year,<span class="st">")"</span>)), <span class="dt">force =</span> <span class="fl">0.25</span>, <span class="dt">size=</span><span class="fl">2.5</span>)</code></pre></div>
<p><img src="Chapter_4_files/figure-html/fig_4_1-1.png" width="672"></p>
</div>
<div id="extension-1-who-are-the-leaders-with-the-greatest-degree-of-personal-power" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#extension-1-who-are-the-leaders-with-the-greatest-degree-of-personal-power" class="anchor"> </a></body></html>Extension 1: Who are the leaders with the greatest degree of personal power?</h3>
<p>This is not necessarily the best way of presenting this information. For example, we can calculate an average personalism score for each leader in the dataset (among those who lasted at least five years in power), accounting for the degree of uncertainty in the index:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">leader_data &lt;-<span class="st"> </span>leader_data %&gt;%
<span class="st">  </span><span class="kw">full_join</span>(personal_scores) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(country_name, GWn, leader, startdate, enddate) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">n</span>() &gt;<span class="st"> </span><span class="dv">5</span>) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">avg_personalism =</span> <span class="kw">mean</span>(-z1),
            <span class="dt">se_personalism =</span> <span class="kw">sqrt</span>(<span class="kw">sum</span>(((z1 -<span class="st"> </span>pct975)/<span class="fl">1.96</span>)^<span class="dv">2</span>))/<span class="kw">n</span>()) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pct975 =</span> avg_personalism +<span class="st"> </span><span class="fl">1.96</span>*se_personalism,
         <span class="dt">pct025 =</span> avg_personalism -<span class="st"> </span><span class="fl">1.96</span>*se_personalism) %&gt;%
<span class="st">  </span><span class="kw">ungroup</span>() %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rank =</span> <span class="kw">percent_rank</span>(avg_personalism),
         <span class="dt">in_book =</span> <span class="kw">grepl</span>(<span class="kw">paste</span>(<span class="kw">c</span>(<span class="st">"amin"</span>,<span class="st">"ceausescu"</span>,<span class="st">"stalin"</span>,
                                 <span class="st">"hugo chavez"</span>,<span class="st">"duvalier"</span>,<span class="st">"hitler"</span>,
                                 <span class="st">"saddam"</span>,<span class="st">"al-assad"</span>,<span class="st">"kim il"</span>,
                                 <span class="st">"kim jong"</span>,<span class="st">"trujillo"</span>,<span class="st">"mao"</span>,
                                 <span class="st">"macias"</span>,<span class="st">"mobutu"</span>,<span class="st">"stroessner"</span>,
                                 <span class="st">"franco"</span>),<span class="dt">collapse =</span> <span class="st">"|"</span>),
                         leader,
                         <span class="dt">ignore.case =</span> <span class="ot">TRUE</span>)) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(leader)) </code></pre></div>
<pre><code>## Joining, by = c("GWn", "year")</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> leader_data %&gt;%<span class="st"> </span><span class="kw">filter</span>(rank &gt;<span class="st"> </span><span class="fl">0.9</span>), <span class="kw">aes</span>(<span class="dt">color =</span> in_book)) +
<span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(<span class="kw">paste0</span>(leader,<span class="st">"</span><span class="ch">\n</span><span class="st">("</span>,country_name,<span class="st">", "</span>,startdate,<span class="st">"-"</span>,enddate,<span class="st">")"</span>), avg_personalism), 
                      <span class="dt">y =</span> avg_personalism,
                      <span class="dt">ymax =</span> pct975,
                      <span class="dt">ymin =</span> pct025)) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">""</span>, <span class="dt">y =</span> <span class="st">"Average personalism score"</span>, <span class="dt">color =</span> <span class="st">"Discussed in book?"</span>) +
<span class="st">  </span><span class="kw">coord_flip</span>() +
<span class="st">  </span><span class="kw">theme_bw</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"top"</span>) +
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">title.position =</span> <span class="st">"top"</span>))</code></pre></div>
<p><img src="Chapter_4_files/figure-html/most_personal_leaders-1.png" width="672"></p>
<p>We can also look at maximum, rather than average, scores for personal power, which shows a different picture:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">leader_data &lt;-<span class="st"> </span>archigos %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(obsid, GWn, leader, startdate,enddate) %&gt;%
<span class="st">  </span><span class="kw">do</span>(<span class="kw">data.frame</span>(<span class="dt">year =</span> <span class="kw">year</span>(.$startdate):<span class="kw">year</span>(.$enddate))) %&gt;%
<span class="st">  </span><span class="kw">full_join</span>(personal_scores) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(country_name, GWn, leader, startdate, enddate) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">n</span>() &gt;<span class="st"> </span><span class="dv">5</span>) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">max_personalism =</span> <span class="kw">max</span>(-z1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">pct975 =</span> -<span class="kw">max</span>(pct975[-z1 ==<span class="st"> </span>max_personalism]),
            <span class="dt">pct025 =</span> -<span class="kw">min</span>(pct025[-z1 ==<span class="st"> </span>max_personalism]),
            <span class="dt">peak_year =</span> <span class="kw">round</span>(<span class="kw">mean</span>(year[-z1 ==<span class="st"> </span>max_personalism], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) %&gt;%
<span class="st">  </span><span class="kw">ungroup</span>() %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rank =</span> <span class="kw">percent_rank</span>(max_personalism),
         <span class="dt">in_book =</span> <span class="kw">grepl</span>(<span class="kw">paste</span>(<span class="kw">c</span>(<span class="st">"amin"</span>,<span class="st">"ceausescu"</span>,<span class="st">"stalin"</span>,
                                 <span class="st">"hugo chavez"</span>,<span class="st">"duvalier"</span>,<span class="st">"hitler"</span>,
                                 <span class="st">"saddam"</span>,<span class="st">"al-assad"</span>,<span class="st">"kim il"</span>,
                                 <span class="st">"kim jong"</span>,<span class="st">"trujillo"</span>,<span class="st">"mao"</span>,
                                 <span class="st">"macias"</span>,<span class="st">"mobutu"</span>,<span class="st">"stroessner"</span>,
                                 <span class="st">"franco"</span>),<span class="dt">collapse =</span> <span class="st">"|"</span>),
                         leader,
                         <span class="dt">ignore.case =</span> <span class="ot">TRUE</span>))  %&gt;%
<span class="st">  </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(leader)) </code></pre></div>
<pre><code>## Joining, by = c("GWn", "year")</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> leader_data %&gt;%<span class="st"> </span><span class="kw">filter</span>(rank &gt;<span class="st"> </span><span class="fl">0.9</span>), <span class="kw">aes</span>(<span class="dt">color =</span> in_book)) +
<span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(<span class="kw">paste0</span>(leader,<span class="st">"</span><span class="ch">\n</span><span class="st">("</span>,country_name,<span class="st">", peak power in "</span>, peak_year,<span class="st">")"</span>), max_personalism),
                      <span class="dt">y =</span> max_personalism,
                      <span class="dt">ymax =</span> pct975,
                      <span class="dt">ymin =</span> pct025)) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">""</span>, <span class="dt">y =</span> <span class="st">"Maximum personalism score"</span>, <span class="dt">color =</span> <span class="st">"Discussed in book?"</span>) +
<span class="st">  </span><span class="kw">coord_flip</span>() +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"top"</span>) +
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">title.position =</span> <span class="st">"top"</span>))</code></pre></div>
<p><img src="Chapter_4_files/figure-html/most_personal_leaders_2-1.png" width="672"></p>
</div>
<div id="extension-2-map-of-leaders-with-the-greatest-degree-of-personal-power-in-1967" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#extension-2-map-of-leaders-with-the-greatest-degree-of-personal-power-in-1967" class="anchor"> </a></body></html>Extension 2: Map of leaders with the greatest degree of personal power in 1967</h3>
<p>Or we can show a map of personal power for a particular year. Here&rsquo;s 1967:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(maptools)
<span class="kw">library</span>(rgeos)


world_1967 &lt;-<span class="st"> </span>cshapes::<span class="kw">cshp</span>(<span class="kw">as.Date</span>(<span class="st">"1967-1-1"</span>)) %&gt;%
<span class="st">  </span><span class="kw">fortify</span>(<span class="dt">region =</span> <span class="st">"GWCODE"</span>) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">GWn =</span> id)

leader_data &lt;-<span class="st"> </span>archigos %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(obsid, GWn, leader, startdate,enddate) %&gt;%
<span class="st">  </span><span class="kw">do</span>(<span class="kw">data.frame</span>(<span class="dt">year =</span> <span class="kw">year</span>(.$startdate):<span class="kw">year</span>(.$enddate))) %&gt;%
<span class="st">  </span><span class="kw">full_join</span>(personal_scores) %&gt;%
<span class="st">  </span><span class="kw">full_join</span>(extended_uds %&gt;%
<span class="st">              </span><span class="kw">select</span>(country_name, GWn, year, lat, lon)) %&gt;%
<span class="st">  </span><span class="kw">ungroup</span>() %&gt;%
<span class="st">  </span><span class="kw">filter</span>(year ==<span class="st"> </span><span class="dv">1967</span>) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rank =</span> <span class="kw">percent_rank</span>(-z1),
         <span class="dt">in_book =</span> <span class="kw">grepl</span>(<span class="kw">paste</span>(<span class="kw">c</span>(<span class="st">"amin"</span>,<span class="st">"ceausescu"</span>,<span class="st">"stalin"</span>,
                                 <span class="st">"hugo chavez"</span>,<span class="st">"duvalier"</span>,<span class="st">"hitler"</span>,
                                 <span class="st">"saddam"</span>,<span class="st">"al-assad"</span>,<span class="st">"kim il"</span>,
                                 <span class="st">"kim jong"</span>,<span class="st">"trujillo"</span>,<span class="st">"mao"</span>,
                                 <span class="st">"macias"</span>,<span class="st">"mobutu"</span>,<span class="st">"stroessner"</span>,
                                 <span class="st">"franco"</span>),<span class="dt">collapse =</span> <span class="st">"|"</span>),
                         leader,
                         <span class="dt">ignore.case =</span> <span class="ot">TRUE</span>)) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(leader)) </code></pre></div>
<pre><code>## Joining, by = c("GWn", "year")</code></pre>
<pre><code>## Joining, by = c("GWn", "year", "country_name")</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> world,
            <span class="kw">aes</span>(<span class="dt">y =</span> lat, <span class="dt">x =</span> long, <span class="dt">group =</span> group)) +
<span class="st">  </span><span class="kw">geom_map</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> z1,
               <span class="dt">map_id =</span> GWn),
           <span class="dt">map =</span> world_1967,
           <span class="dt">data =</span> personal_scores %&gt;%<span class="st"> </span><span class="kw">filter</span>(year ==<span class="st"> </span><span class="dv">1967</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> world_1967,
            <span class="kw">aes</span>(<span class="dt">y =</span> lat, <span class="dt">x =</span> long, <span class="dt">group =</span> group)) +
<span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> leader_data %&gt;%<span class="st"> </span><span class="kw">filter</span>(rank &gt;<span class="st"> </span><span class="fl">0.8</span>),
                  <span class="kw">aes</span>(<span class="dt">x =</span> lon,
                      <span class="dt">y =</span> lat,
                      <span class="dt">label =</span> leader,
                      <span class="dt">color =</span> forcats::<span class="kw">fct_rev</span>(<span class="kw">as.factor</span>(in_book))),
                  <span class="dt">force =</span> <span class="fl">0.25</span>, <span class="dt">size=</span><span class="fl">2.5</span>) +
<span class="st">  </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">mid =</span> <span class="st">"lightgrey"</span>) +
<span class="st">  </span><span class="kw">scale_color_grey</span>() +
<span class="st">  </span><span class="kw">theme_minimal</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">"Degree of personal power</span>
<span class="st">       (redder is greater)"</span>,
       <span class="dt">x =</span> <span class="st">""</span>,
       <span class="dt">y =</span> <span class="st">""</span>,
       <span class="dt">color =</span> <span class="st">"Discussed in book?"</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">title.position =</span> <span class="st">"top"</span>)) +
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="ot">NULL</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="ot">NULL</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) </code></pre></div>
<p><img src="Chapter_4_files/figure-html/map_1967-1.png" width="672"></p>
</div>
</div>
<div id="fig-4-2-manner-of-exit-for-all-political-leaders-by-degree-of-personal-power" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#fig-4-2-manner-of-exit-for-all-political-leaders-by-degree-of-personal-power" class="anchor"> </a></body></html>Fig 4.2: Manner of exit for all political leaders, by degree of personal power</h2>
<div id="original-figure-1" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#original-figure-1" class="anchor"> </a></body></html>Original figure</h3>
<p>Information on leader exit is from <span class="citation">Goemans, Gleditsch, and Chiozza (2009)</span>. The code for this figure corrects a small error in the published figure (so small as to be almost unnoticeable!):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">left_join</span>(archigos %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw">year</span>(enddate)),
                  personal_scores %&gt;%<span class="st"> </span>
<span class="st">                    </span><span class="kw">group_by</span>(country_name) %&gt;%<span class="st"> </span>
<span class="st">                    </span><span class="kw">mutate</span>(<span class="dt">z1 =</span> -z1, <span class="dt">lag_value =</span> <span class="kw">lag</span>(z1))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">exitcode =</span> <span class="kw">ifelse</span>(exit ==<span class="st"> "Natural Death"</span>, <span class="st">"Natural Death"</span>, <span class="kw">as.character</span>(exitcode))) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">exitcode =</span> <span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">"Military"</span>,exitcode),<span class="st">"Military,</span><span class="ch">\n</span><span class="st">with or without foreign support"</span>,
                           <span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">"Popular"</span>,exitcode),
                                  <span class="st">"Popular protest,</span><span class="ch">\n</span><span class="st">with or without foreign support"</span>,
                                  <span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">"Other Government"</span>, exitcode),
                                         <span class="st">"Other government actors,</span><span class="ch">\n</span><span class="st">with or without foreign support"</span>,
                                         <span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">"Rebels"</span>, exitcode),
                                                <span class="st">"Rebels,</span><span class="ch">\n</span><span class="st">with or without foreign support"</span>,
                                                exitcode)))),
         <span class="dt">exitcode =</span> plyr::<span class="kw">mapvalues</span>(exitcode, 
                                    <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">"Removed through Threat of Foreign Force"</span>,
                                             <span class="st">"Assassination by Unsupported Individual"</span>), 
                                    <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">"Foreign force"</span>,<span class="st">"Assassination"</span>))) </code></pre></div>
<pre><code>## Joining, by = c("country_name", "GWn", "year")</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>data %&gt;%<span class="st"> </span><span class="kw">filter</span>(exit !=<span class="st"> "Still in Office"</span>),
       <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">reorder</span>(exitcode, lag_value, <span class="dt">FUN=</span>median, <span class="dt">na.rm=</span><span class="ot">TRUE</span>), <span class="dt">y=</span> lag_value)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">varwidth=</span><span class="ot">TRUE</span>) +
<span class="st">  </span><span class="kw">coord_flip</span>() +
<span class="st">  </span><span class="kw">theme_bw</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">""</span>,<span class="dt">y=</span><span class="st">"Index of personal power at the time</span><span class="ch">\n</span><span class="st">of exit from office"</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_grey</span>(<span class="dt">na.value=</span><span class="st">"white"</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="kw">guide_legend</span>(<span class="dt">title.position=</span><span class="st">"top"</span>)) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">"bottom"</span>) +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>,<span class="dt">linetype=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>## Warning: Removed 61 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="Chapter_4_files/figure-html/fig_4_2-1.png" width="672"></p>
</div>
<div id="extension-1-violin-plot-of-distribution-of-leader-exits-by-degree-of-personal-power" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#extension-1-violin-plot-of-distribution-of-leader-exits-by-degree-of-personal-power" class="anchor"> </a></body></html>Extension 1: Violin plot of distribution of leader exits by degree of personal power</h3>
<p>We can also use a violin plot to see the distribution better:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>data %&gt;%<span class="st"> </span><span class="kw">filter</span>(exit !=<span class="st"> "Still in Office"</span>),
       <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">reorder</span>(exitcode, lag_value, <span class="dt">FUN=</span>median, <span class="dt">na.rm=</span><span class="ot">TRUE</span>), <span class="dt">y=</span> lag_value)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_violin</span>(<span class="dt">draw_quantiles =</span> <span class="kw">c</span>(<span class="fl">0.15</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>)) +
<span class="st">  </span><span class="kw">coord_flip</span>() +
<span class="st">  </span><span class="kw">theme_bw</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">""</span>,<span class="dt">y=</span><span class="st">"Index of personal power at the time</span><span class="ch">\n</span><span class="st">of exit from office"</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_grey</span>(<span class="dt">na.value=</span><span class="st">"white"</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="kw">guide_legend</span>(<span class="dt">title.position=</span><span class="st">"top"</span>)) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">"bottom"</span>) +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>,<span class="dt">linetype=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>## Warning: Removed 61 rows containing non-finite values (stat_ydensity).</code></pre>
<p><img src="Chapter_4_files/figure-html/fig_4_2_violin-1.png" width="672"></p>
</div>
</div>
<div id="fig--4-3-manner-of-exit-of-non-democratic-leaders" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#fig--4-3-manner-of-exit-of-non-democratic-leaders" class="anchor"> </a></body></html>Fig. 4.3: Manner of exit of non-democratic leaders</h2>
<div id="original-figure-2" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#original-figure-2" class="anchor"> </a></body></html>Original figure</h3>
<p>This figure uses data from <span class="citation">Svolik (2012)</span> about the manner of exit of each political leader. There is an error in the book that is corrected in the code below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span>svolik_leader %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(country_name) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">next_pol_aff =</span> <span class="kw">lead</span>(pol_aff))  %&gt;%
<span class="st">  </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(next_pol_aff), !<span class="kw">is.na</span>(exit)) %&gt;%
<span class="st">  </span><span class="kw">ungroup</span>()

data &lt;-<span class="st"> </span><span class="kw">left_join</span>(data, <span class="kw">count</span>(data, exit)) </code></pre></div>
<pre><code>## Joining, by = "exit"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>data,
       <span class="kw">aes</span>(<span class="dt">fill =</span> next_pol_aff,
           <span class="dt">x =</span> <span class="kw">reorder</span>(exit, n))) +
<span class="st">  </span><span class="kw">geom_bar</span>() +
<span class="st">  </span><span class="kw">coord_flip</span>() +
<span class="st">  </span><span class="kw">theme_bw</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">""</span>,<span class="dt">y=</span><span class="st">"Number of non-democratic leaders"</span>,
       <span class="dt">fill=</span><span class="st">"Political affiliation </span><span class="ch">\n</span><span class="st">of next leader"</span>)  +<span class="st"> </span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="kw">guide_legend</span>(<span class="dt">title.position=</span><span class="st">"top"</span>)) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">"bottom"</span>)</code></pre></div>
<p><img src="Chapter_4_files/figure-html/fig%204_3-1.png" width="672"></p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor"><html><body><a href="#references" class="anchor"> </a></body></html>References</h2>
<div id="refs" class="references">
<div id="ref-GoemansGleditschChiozza2009">
<p>Goemans, Henk, Kristian Gleditsch, and Giacomo Chiozza. 2009. &ldquo;Introducing Archigos: A Dataset of Political Leaders.&rdquo; <em>Journal of Peace Research</em> 46 (2): 269&ndash;83.</p>
</div>
<div id="ref-Svolik2012">
<p>Svolik, Milan. 2012. <em>The Politics of Authoritarian Rule</em>. Book. Cambridge: Cambridge University Press.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#introduction">Introduction</a></li>
      <li><a href="#figure-4.1-personal-rule-around-the-world">Figure 4.1: Personal Rule Around the World</a></li>
      <li><a href="#fig-4.2-manner-of-exit-for-all-political-leaders-by-degree-of-personal-power">Fig 4.2: Manner of exit for all political leaders, by degree of personal power</a></li>
      <li><a href="#fig.-4.3-manner-of-exit-of-non-democratic-leaders">Fig. 4.3: Manner of exit of non-democratic leaders</a></li>
      <li><a href="#references">References</a></li>
      </ul></div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Xavier Marquez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer></div>

  </body></html>
